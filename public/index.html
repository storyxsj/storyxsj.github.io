<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">

<script type="text/javascript" src="public/moon/js/main.js"></script>

<!-- jqueryMain -->
<script type="text/javascript" src="public/jquery/jquery1.12.js"></script>
<script type="text/javascript" src="public/jquery/jquery1.12.min.js"></script>

<!-- jqueryAlert -->
<script type="text/javascript" src="public/jquery/jquery.alert.js"></script>
<link rel="stylesheet" type="text/css"
	href="public/jquery/jquery.alert.css" />

<!-- dataTables -->
<script type="text/javascript" src="public/datatables/js/jquery.js"></script>
<script type="text/javascript"
	src="public/datatables/js/jquery.dataTables.min.js"></script>
<script type="text/javascript"
	src="public/datatables/js/dataTables.wrap.js"></script>
<link rel="stylesheet" type="text/css"
	href="public/datatables/css/jquery.dataTables.min.css" />
<link rel="stylesheet" type="text/css"
	href="public/datatables/css/dataTables.wrap.css" />


<script type="text/javascript"
	src="public/layer/layer.js"></script>

<link rel="stylesheet" type="text/css"
	href="public/layui/css/layui.css" />
<script type="text/javascript"
	src="public/layui/layui.js"></script>

<script type="text/javascript"
	src="public/echarts/echarts.min.js"></script>
<script type="text/javascript"
	src="public/echarts/echarts.wrap.js"></script>


<script>

$(document).ready(function() {
	
});

function test(){
	var a = $("input[name='stockName']").val();
	var b = $("input[name='stockPasswd']").val();
	
	console.info(a);
	console.info(b);
}

var c;
function jump(day){
	var a = $("input[name='stockName']").val();
	if(a == ""){
		layer.msg("请输入股票代码");
		return;
	}
	var b = $("input[name='stockPasswd']").val();
	
	if(b == ""){
		b = c;
	}else{
		c = b;
	}
	
	
	var baseURL = "https://money.finance.sina.com.cn/quotes_service/api/json"+b+".php";
	var stockCode = a;//股票代码
	var scale = day;//数据周期  日线240
	var datalen = "200";//个数
	var now = new Date().getTime();
	var paramName = "_"+stockCode+"_"+scale+"_"+now;//_sz000731_5_1518135258158
	var url = baseURL+"/var%20"+paramName+"=/CN_MarketData.getKLineData?symbol="+stockCode+"&scale="+scale+"&ma=no&datalen="+datalen;
	
	
	$.ajax({'url':url, 'dataType':'jsonp'}).always(function(d){kline(window[paramName],"kk")});
}

function kkformatData(jsonData){
	var adata = [];
	var i=0;
	for(var o in jsonData){
		var sdata = [];
		sdata[0] = jsonData[o].day;
		sdata[1] = jsonData[o].open;
		sdata[2] = jsonData[o].close;
		sdata[3] = jsonData[o].low;
		sdata[4] = jsonData[o].high;
		adata[i] = sdata;
		i++;
      }  

	var day = [];
	var open = [];
	var close = [];
	var low = [];
	var high = [];
	for(var j=0;j<i;j++){
		day[j] = adata[i-1-j][0];
		open[j] = adata[i-1-j][1];
		close[j] = adata[i-1-j][2];
		low[j] = adata[i-1-j][3];
		high[j] = adata[i-1-j][4];
	}
	
	
	layuitableInsert("day",day);
	layuitableInsert("open",open);
	layuitableInsert("close",close);
	layuitableInsert("low",low);
	layuitableInsert("high",high);
	
	chan(day,open,close,low,high);
	return adata;
}



</script>
</head>
<body>
<div class="layui-row">
<br>
</div>

<div class="layui-row">
	<div class="layui-col-md4">
		股票代码：<input type="text" name="stockName" required  lay-verify="required" placeholder="请输入股票代码" autocomplete="off" >
	</div>
	<div class="layui-col-md4">
		密码：<input type="text" name="stockPasswd" required  lay-verify="required" placeholder="请输入密码" autocomplete="off" >
	</div>
	<div class="layui-col-md4">
		
	</div>
</div>
<div class="layui-row"></div>

<button class="layui-btn" onclick="jump('5');">5分钟</button>
<button class="layui-btn" onclick="jump('30');">30分钟</button>
<button class="layui-btn" onclick="jump('240');">日线</button>
<button class="layui-btn" onclick="test('240');">测试用</button>
<div id="kk" style="height: 450px;width:90%"></div>





</body>
</html>